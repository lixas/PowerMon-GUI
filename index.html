<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, viewport-fit=cover"
		/>
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
		<meta name="theme-color" content="#2196f3" />
		<meta
			http-equiv="Content-Security-Policy"
			content="default-src * 'self' 'unsafe-inline' 'unsafe-eval' data:"
		/>
		<title>Power Monitor</title>
		<link rel="stylesheet" href="css/framework7-bundle.min.css" />
		<link rel="stylesheet" href="css/framework7-icons.css" />
		<style>
			:root {
				--f7-bars-shadow-bottom-image: none;
				--f7-searchbar-input-padding-horizontal: 24px;
				--f7-navbar-margin: 12px;
			}

			/* .avatar {
        width: 28px;
        height: 28px;
        border-radius: 50%;
      } */

			.navbar {
				/* margin: 24px var(--f7-navbar-margin); */
				/* width: calc(100% - 2 * var(--f7-navbar-margin)); */
				border-radius: 12px;
				overflow: hidden;
				--f7-navbar-bg-color: #fff;
			}

			.dark .navbar {
				--f7-navbar-bg-color: #000;
			}

			.navbar .title {
				width: 100%;
				margin: 0;
			}

			/* .page-content {
      padding-top: 112px;
    } */
			/* Limit resizable panel width */
			.panel {
				width: 70vw;
			}
		</style>
	</head>
	<body>
		<div id="app">
			<div class="panel panel-left panel-cover">
				<div class="page page-accounts">
					<div class="page-content">
						<div class="block-title .round" style="background-image:url(images/GreenBack.jpg); padding-bottom:10px; border-radius: 8px; color: #fff">
							<div class="margin-left">
							<img src="images/website_logo.png" />
							<p class="title">Ignas Bukys</p>
							http://www.bukys.eu
							</div>
						</div>
						<div class="list no-chevron">
							<!-- Light and dark theme icons -->
							<div class="item-media">
								<i class="icon f7-icons" onclick="setLayoutTheme('light')">sun_max</i>
								<i class="icon f7-icons" onclick="setLayoutTheme('dark')">moon</i>
								Switch theme
							</div>
							<div class="list list-outline-ios list-strong-ios list-dividers-ios"></div>
							<ul>
								<li>
									<a href="/settings" class="item-content item-link panel-close" data-transition="f7-cover">
										<div class="item-media">
											<i class="icon f7-icons">gear_alt</i>
										</div>
										<div class="item-inner">
											<div class="item-title">Settings</div>
										</div>
									</a>
								</li>
								<li>
									<a href="/about" class="item-content item-link panel-close" data-transition="f7-cover" >
										<div class="item-media">
											<i class="icon f7-icons">question_circle</i>
										</div>
										<div class="item-inner">
											<div class="item-title">About</div>
										</div>
									</a>
								</li>
								<div class="list list-outline-ios list-strong-ios list-dividers-ios"></div>
								<li>
									<a href="http://www.bukys.eu/me/start" target="_blank" class="item-content item-link link external">
										<div class="item-media">
											<i class="icon f7-icons">person</i>
										</div>
										<div class="item-inner">
											<div class="item-title">About Me</div>
										</div>
									</a>
								</li>
								<li>
									<a href="http://www.bukys.eu" target="_blank" class="item-content item-link link external">
										<div class="item-media">
											<i class="icon f7-icons">archivebox</i>
										</div>
										<div class="item-inner">
											<div class="item-title">Website</div>
										</div>
									</a>
								</li>
								<div class="list list-outline-ios list-strong-ios list-dividers-ios"></div>
								<li>
									<a href="#" class="item-content item-link" onClick="helloWorld()" >
										<div class="item-media">
											<i class="icon f7-icons">tray_arrow_down</i>
										</div>
										<div class="item-inner">
											<div class="item-title">Upgrade available</div>
											<div class="item-after">
												<div class="badge">Ver. 0.4</div>
											</div>
										</div>
									</a>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<div class="view view-main view-init">
				<div class="page no-navbar">
					<div class="page-content">
						<div class="navbar">
							<div class="navbar-bg"></div>
							<div class="navbar-inner">
								<div class="left">
									<a class="link panel-open icon-only" data-panel="left">
										<i class="icon f7-icons">bars</i>
									</a>
								</div>
								<div class="title">Power Monitor</div>
								<div class="right">
									<a class="link icon-only navbar-tooltip">
										<i class="icon f7-icons">bolt_slash</i>
									</a>
								</div>
							</div>
						</div>
						<div class="block">
							<!-- Area Chart element -->
							<div class="area-chart area-chart-lines"></div>
							<!-- main content begin -->
							
							<div class="data-table">
								<table>
									<thead>
										<tr>
											<th class="label-cell">Measurement</th>
											<th class="numeric-cell">Value</th>
											<th class="text-cell">Unit</th>
										</tr>
									</thead>
									<tbody>
										<tr>
											<td class="label-cell">Voltage</td>
											<td class="numeric-cell">4.20</td>
											<td class="text-cell">V</td>
										</tr>
										<tr>
											<td class="label-cell">Current</td>
											<td class="numeric-cell">1.39</td>
											<td class="text-cell">A</td>
										</tr>
										<tr>
											<td class="label-cell">Power</td>
											<td class="numeric-cell">5.838</td>
											<td class="text-cell">W</td>
										</tr>
										<tr>
											<td class="label-cell">Time</td>
											<td colspan="2" class="numeric-cell">74:37:13</td>
										</tr>
									</tbody>
								</table>
							</div>
	<!-- 							 -->
							<div class="block-title"><i class="icon f7-icons">info_circle</i> Device remote control</div>
							<div class="block block-strong block-outline-ios">
								<div class="grid grid-cols-4 grid-gap">
									<button class="button button-tonal">Setup</button>
									<button class="button button-tonal">-</button>
									<button class="button button-tonal">+</button>
									<button class="button button-tonal">Enter</button>
								</div>
							</div>
							<div class="block-footer">Using these buttons you can control device. You must have visual with the device to see what you are doing.</div>
<!-- 							 -->
						</div>
					</div>
				</div>
			</div>
		</div>

		<script src="js/framework7-bundle.min.js"></script>
		<script>
			var $$ = Dom7;
			var globalTheme = 'dark';
			let theme = globalTheme;
			const webapp = new Framework7({
				el: '#app',
				theme: 'md',
				routes: [
					{
						path: '/',
						componentUrl: './index.html',
					},
					{
						path: '/settings',
						componentUrl: './settings.html',
					},
					{
						path: '/about',
						componentUrl: './about.html',
					},
				],
				// App root methods
				methods: {
					helloWorld: function () {
						webapp.dialog.alert('Hello World!');
					},
					backonepage: function () {
						webapp.views.main.router.back();
					},
				},
				view: {
					pushState: true,
				},
				touch: {
					tapHold: true,
				},
			});
			
			function helloWorld() {
						webapp.dialog.alert('This action will begin new version download', 'Updater');
			};

			navbarTooltip = webapp.tooltip.create({
				targetEl: '.navbar-tooltip',
				text: 'One more tooltip<br />with more text<br /><em>and custom formatting</em>',
			});

			const setLayoutTheme = (newTheme) => {
				var $$html = $$('html');
				globalTheme = newTheme;
				$$html.removeClass('dark light').addClass(globalTheme);
				theme = globalTheme;
				// checkTheme();
			};
			// const checkTheme = () => {
			//   if (theme === 'light') {
			//     document.getElementById("light").checked = true;
			//     document.getElementById("dark").checked = false;
			//   } else {
			//     document.getElementById("light").checked = false;
			//     document.getElementById("dark").checked = true;
			//   }
			// }
			// // create searchbar
			// const searchbar = app.searchbar.create({
			//   el: '.searchbar',
			//   searchContainer: '.list-email',
			//   searchIn: '.item-title',
			//   on: {
			//     search(sb, query, previousQuery) {
			//       console.log(query, previousQuery);
			//     }
			//   }
			// });
			setLayoutTheme(globalTheme);
			// checkTheme();

			let areaLines;
			// helpers data for axis
			const dates = [];
			const today = new Date();
			const year = today.getFullYear();
			const month = today.getMonth();
			for (let i = 0; i < 40; i += 1) {
				dates.push(new Date(year, month - (3 - i)));
			}
			const axisDateFormat = Intl.DateTimeFormat(undefined, {
				month: 'short',
				year: 'numeric',
			});
			const tooltipDateFormat = Intl.DateTimeFormat(undefined, {
				month: 'long',
				year: 'numeric',
			});
			areaLines = webapp.areaChart.create({
				el: '.area-chart-lines',
				tooltip: true,
				axis: true,
				axisLabels: dates,
				legend: true,
				toggleDatasets: true,
				lineChart: true,
				formatAxisLabel(date) {
					return axisDateFormat.format(date);
				},
				formatTooltipAxisLabel(date) {
					return tooltipDateFormat.format(date);
				},
				datasets: [
					{
						label: 'Vol',
						color: '#f00',
						values: [220, 225, 218, 225],
					},
					{
						label: 'Cur',
						color: '#00f',
						values: [50, 75, 83, 67],
					},
					{
						label: 'Ene',
						color: '#0f0',
						values: [0, 100, 250, 307],
					},
				],
			});

			// and when we need to update rendered SVG based on new datasets:
			setTimeout(() => {
				areaLines.update({
					axisLabels: [9, 8, 7, 6, 5],
					datasets: [
						{
							label: 'Vol',
							color: '#f00',
							values: [220, 225, 218, 225, 210],
						},
						{
							label: 'Cur',
							color: '#00f',
							values: [50, 75, 83, 67, 55],
						},
						{
							label: 'Ene',
							color: '#0f0',
							values: [0, 100, 250, 307, 300],
						},
					],
				});
			}, '5000');

			window.Measurements = [
				{ key: 'Vol',				checked: true,	title: 'Voltage',					idx: 0, val: ['V']					},
				{ key: 'Cur',				checked: true,	title: 'Current',					idx: 0, val: ['A']					},
				{ key: 'Pwr',				checked: true,	title: 'Power',						idx: 0, val: ['W', 'kW']		},
				{ key: 'Cap',				checked: false,	title: 'Capacity',				idx: 0, val: ['Ah', 'mAh']	},
				{ key: 'Ene',				checked: true,	title: 'Energy',					idx: 0, val: ['Wh', 'kWh']	},
				{ key: 'DMinPlus',	checked: false,	title: 'Data lines volt',	idx: 0, val: ['V']					},
				{ key: 'Price',			checked: false, title: 'Price per kWh',		idx: 0, val: ['¤/kWh']			},
				{ key: 'Cost',			checked: false, title: 'Cost',						idx: 0, val: ['¤']					},
				{ key: 'Freq',			checked: false, title: 'Frequency',				idx: 0, val: ['Hz']					},
				{ key: 'PowFact',		checked: false, title: 'Power Factor',		idx: 0, val: ['']						},
				{ key: 'Temp',			checked: false, title: 'Temperature',			idx: 0, val: ['°C', '°F']		},
				{ key: 'Time',			checked: true,	title: 'Time',						idx: 0, val: ['']						},
			];
		</script>
	</body>
</html>